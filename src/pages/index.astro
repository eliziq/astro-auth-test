---
import Layout from "../layouts/Layout.astro";
import LogoutButton from "../components/LogoutButton.astro";

const pageTitle = "Welcome";
const pageDescription = "Welcome to our application";

---

<Layout title={pageTitle} description={pageDescription}>
	<main class="home-page">
		<div class="container">
			<h1>Welcome to Our App</h1>
			<p class="subtitle">Get started by signing in to your account</p>
			<div class="cta-buttons">
				<a href="/login" class="btn btn-primary">
					Sign In
				</a>
				<a href="/register" class="btn btn-secondary">
					Create Account
				</a>
			</div>
		</div>
	</main>

	<script>
		// Check if user is authenticated after page load
		const userJson = localStorage.getItem("user");
		const user = userJson ? JSON.parse(userJson) : null;
		
		if (user) {
				// Update to logged-in view
				const container = document.querySelector('.container');
				if (container) {
					container.innerHTML = `
						<h1>Welcome back, ${user.firstName}!</h1>
						<p class="subtitle">You are now logged in to your account</p>
						<div class="cta-buttons">
							<a href="/dashboard" class="btn btn-primary">
								Go to Dashboard
							</a>
							<LogoutButton />
						</div>
					`;
				}
			}

		// This script ensures the page updates when the auth state changes
		window.addEventListener("storage", (event) => {
			if (event.key === "auth_token" || event.key === "user") {
				window.location.reload();
			}
		});
	</script>

	<style>
		@import "../styles/buttons.css";

		.home-page {
			min-height: 100vh;
			display: flex;
			align-items: center;
			justify-content: center;
			text-align: center;
			padding: 2rem;
			background-color: #f5f7fa;
		}

		.container {
			max-width: 600px;
		}

		h1 {
			color: #1a1a1a;
			margin-bottom: 1rem;
			font-size: 2.5rem;
		}

		.subtitle {
			color: #666;
			font-size: 1.25rem;
			margin-bottom: 2rem;
		}

		.cta-buttons {
			display: flex;
			gap: 1rem;
			justify-content: center;
		}

		@media (max-width: 480px) {
			.cta-buttons {
				flex-direction: column;
				gap: 0.75rem;
			}

			.btn {
				width: 100%;
			}
		}
	</style>
</Layout>
